<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="chrome=1" />
  <title>Developer by salemove</title>

  <link rel="stylesheet" href="stylesheets/styles.css" />
  <link rel="stylesheet" href="stylesheets/pygment_trac.css" />
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
  <!--[if lt IE 9]>
  <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
</head>

<div class="wrapper">
  <header>
  </header>
<section>



<h1 id="operator-public-api">Operator public API.</h1>
<p>The operator public API consist of HTTP REST endpoints. This means it can be used through browser, command line, by another server, etc.</p>

<h2 id="headers">Headers</h2>
<p>To use the REST API, the request needs to include at least 2 headers: <code>Authorization</code> and <code>Accept</code></p>

<h3 id="authorization">Authorization</h3>
<p>To use the REST API, the request needs to include either the operator <code>SessionId</code> or <code>ApiToken</code>. The preferred approach is using API token, which you can request from our support. The API token is given per operator and currently only operators with manager status have privileges to use them.</p>

<h4 id="api-token-example">API token example</h4>
<p>To use an API token, request the API token from our support and attach it to the request headers. An example with curl:</p>

<pre><code>curl -i https://api.salemove.com/engagements --header "Authorization: ApiToken MY_SECRET_API_TOKEN"
</code></pre>

<p>Example with javascript:</p>

<pre><code>$.ajax({
  type: 'GET',
  url: 'https://api.salemove.com/engagements',
  headers: {
    'Authorization': 'ApiToken MY_SECRET_API_TOKEN'
  },
  success: function(response){
      ajaxResponse = response;
  }
});
</code></pre>

<h3 id="accept-token">Accept token</h3>

<p>The API version must be explicitly set in the request <code>Accept</code> header.</p>

<pre><code>Accept: application/vnd.salemove.v1+json
</code></pre>

<h1 id="rest-api">REST API</h1>

<h2 id="list-engagements">List engagements</h2>

<pre><code>GET /enagements
</code></pre>

<p>Fetches a collection of all engagements that the current manager can see. The manager needs to have access to the site to be able to fetch an engagement from there. The collection is paginated and ordered by ascending ID.</p>

<ul>
  <li>
    <p>Response 200 (application/json)</p>

    <pre><code>[{
  "href" =&gt; "https://api.salemove.com/engagements/#{first_engagement.id}",
  "duration" =&gt; 30,
  "operators" =&gt; [
    {
      "href" =&gt; "https://api.salemove.com/operators/#{first_operator.id}"
    }
  ],
  "visitor" =&gt; {
    "href" =&gt; "https://api.salemove.com/visitors/#{visitor.id}"
  },
  "chat_transcript" =&gt;
  {
    "href" =&gt; "https://api.salemove.com/engagements/#{first_engagement.id}/chat_trascript"
  },
  "audio_recording" =&gt;
  {
    "href" =&gt; "https://api.salemove.com/recording/url"
  }
},
{
  "href" =&gt; "https://api.salemove.com/engagements/#{second_engagement.id}",
  "duration" =&gt; 30,
  "operators" =&gt; [
    {
      "href" =&gt; "https://api.salemove.com/operators/#{second_operator.id}"
    }
  ],
  "visitor" =&gt; {
    "href" =&gt; "https://api.salemove.com/visitors/#{second_visitor.id}"
  },
  "chat_transcript" =&gt;
  {
    "href" =&gt; "https://api.salemove.com/engagements/#{second_engagement.id}/chat_trascript"
  },
  "audio_recording" =&gt; { "href" =&gt; nil }
}]
</code></pre>
  </li>
</ul>

<h2 id="get-single-engagement">Get single engagement</h2>

<pre><code>GET /enagement/:engagement_id
</code></pre>

<p>Fetches an engagement. The manager needs to have access to the site that the engagement took place on.</p>

<ul>
  <li>
    <p>Response 200 (application/json)</p>

    <pre><code>{
  "href" =&gt; "https://api.salemove.com/engagements/#{first_engagement.id}",
  "duration" =&gt; 30,
  "operators" =&gt; [
    {
      "href" =&gt; "https://api.salemove.com/operators/#{first_operator.id}"
    }
  ],
  "visitor" =&gt; {
    "href" =&gt; "https://api.salemove.com/visitors/#{visitor.id}"
  },
  "chat_transcript" =&gt;
  {
    "href" =&gt; "https://api.salemove.com/engagements/#{first_engagement.id}/chat_trascript"
  },
  "audio_recording" =&gt;
  {
    "href" =&gt; "https://api.salemove.com/recording/url"
  }
}
</code></pre>
  </li>
</ul>

<h2 id="get-engagement-chat-transcript">Get engagement chat transcript</h2>

<pre><code>GET /enagement/:engagement_id/chat_transcript
</code></pre>

<p>Fetches the engagements chat transcript. The manager needs to be able to have access site that the chat took place on.</p>

<ul>
  <li>
    <p>Response 200 (application/json)</p>

    <pre><code>[
  {
    "message" =&gt; "This",
    "created_at" =&gt; message1.created_at,
    "sender" =&gt; {
      "href" =&gt; "https://api.salemove.com:visitors/#{visitor.id}",
      "name" =&gt; nil,
      "type" =&gt; "visitor"
    }
  },
  {
    "message" =&gt; "is",
    "created_at" =&gt; message2.created_at,
    "sender" =&gt; {
      "href" =&gt; "https://api.salemove.com:operators/#{first_operator.id}",
      "name" =&gt; "Kalle Kaalikas",
      "type" =&gt; "operator"
    }
  },
  {
    "message" =&gt; "chat",
    "created_at" =&gt; message3.created_at,
    "sender" =&gt; {
      "href" =&gt; "https://api.salemove.com:operators/#{first_operator.id}",
      "name" =&gt; 'Kalle Kaalikas',
      "type" =&gt; 'operator'
    }
  }
]
</code></pre>
  </li>
</ul>

<h2 id="get-visitor-by-id">Get visitor by id</h2>

<pre><code>GET /visitors/:visitor_id
</code></pre>

<p>Fetches the engagements chat transcript. The manager needs to be able to have access to the site that the visitor visited.</p>

<ul>
  <li>
    <p>Response 200 (application/json)</p>

    <pre><code>{
  "href" =&gt; "https://api.salemove.com/visitors/#{visitor.id}",
  "name" =&gt; 'John',
  "email" =&gt; 'test@email.com',
  "phone" =&gt; '55443322',
  "note" =&gt; 'some random dude',
  "custom_attributes" =&gt; {
    "home_address" =&gt; 'Winston',
    "vip" =&gt; "true"
  }
}
</code></pre>
  </li>
</ul>

<h2 id="list-operators">List operators</h2>

<pre><code>GET /operators
</code></pre>

<p>Fetches an operator that the manager can administer. The manager needs to have access to the site to be able to fetch an operator from there.</p>

<ul>
  <li>
    <p>Response 200 (application/json)</p>

    <pre><code>[{
  "href" =&gt; "https://api.salemove.com/operators/#{snd_operator.id}",
  "name" =&gt; 'John',
  "email" =&gt; 'test@email.com',
  "phone" =&gt; '55443322',
  "available" =&gt; true,
  "role" =&gt; 'operator'
}]
</code></pre>
  </li>
</ul>

<h2 id="get-an-operator">Get an operator</h2>

<pre><code>GET /operators/:operator_id
</code></pre>

<p>Lists all the operators that the manager can administer. The manager needs to have access to the site to be able to fetch an operator from there. The collection is paginated and ordered by ascending ID.</p>

<ul>
  <li>
    <p>Response 200 (application/json)</p>

    <pre><code>[{
  "href" =&gt; "https://api.salemove.com/operators/#{manager.id}",
  "name" =&gt; 'Manager',
  "email" =&gt; 'manager@email.com',
  "phone" =&gt; '55443322',
  "available" =&gt; true,
  "role" =&gt; 'manager'
},
{
  "href" =&gt; "https://api.salemove.com/operators/#{snd_operator.id}",
  "name" =&gt; 'John',
  "email" =&gt; 'test@email.com',
  "phone" =&gt; '55443322',
  "available" =&gt; true,
  "role" =&gt; 'operator'
}]
</code></pre>
  </li>
</ul>

<h3 id="update-an-operator">Update an operator</h3>

<pre><code>PATCH /operators/:operator_id
</code></pre>

<ul>
  <li>
    <p>Request body</p>

    <pre><code>  {
    "name": 'Merry John',
    "email": 'some@new.email',
    "phone": '999993333',
    "available": false,
  }
</code></pre>
  </li>
  <li>
    <p>Response 200 (application/json)</p>

    <pre><code>  {
    "href" =&gt; "https://api.salemove.com/operators/#{snd_operator.id}",
    "name" =&gt; 'Merry John',
    "email" =&gt; 'some@new.email',
    "phone" =&gt; '999993333',
    "available" =&gt; false,
    "role" =&gt; 'operator'
  }
</code></pre>
  </li>
</ul>


</section>
<aside id="sidebar">
  <h1>Operator API</h1>
    <p class="view"><a href="https://github.com/salemove/developer">View the Project on GitHub <small>salemove/developer</small></a></p>

  <h2><a href="#" class="js-expand-btn collapsed arrow-btn" data-proofer-ignore=""></a><a href="index.html">Overview</a></h2>
  <ul class="js-guides">
    <li><a href="operator.html">Operator</a></li>
    <li><a href="visitor.html">Visitor</a></li>
  
  


      <footer>
        <p>This project is maintained by <a href="https://github.com/salemove">salemove</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>

</ul></aside></div>
